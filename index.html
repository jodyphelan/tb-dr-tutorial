
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>LSHTM Omics</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tb-drug-resistance-tutorial" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="LSHTM Omics" class="md-header__button md-logo" aria-label="LSHTM Omics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LSHTM Omics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TB Drug resistance tutorial
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="." class="md-tabs__link">
        
  
  
    
  
  TB Drug resistance tutorial

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="LSHTM Omics" class="md-nav__button md-logo" aria-label="LSHTM Omics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    LSHTM Omics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    TB Drug resistance tutorial
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    TB Drug resistance tutorial
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learing-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      Learing objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setting-up-the-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Setting up the environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting up the environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-the-tools-on-your-local-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Installing the tools on your local machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-github-codespaces" class="md-nav__link">
    <span class="md-ellipsis">
      Using GitHub Codespaces
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using GitHub Codespaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#github-codespaces" class="md-nav__link">
    <span class="md-ellipsis">
      GitHub Codespaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visual-studio-code-vs-code" class="md-nav__link">
    <span class="md-ellipsis">
      Visual Studio Code (VS Code)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-these-work-together" class="md-nav__link">
    <span class="md-ellipsis">
      How These Work Together:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Getting set up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Getting set up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-set-up-a-github-account" class="md-nav__link">
    <span class="md-ellipsis">
      1. Set up a GitHub account
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-download-visual-studio-code" class="md-nav__link">
    <span class="md-ellipsis">
      2. Download Visual Studio Code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-get-connected" class="md-nav__link">
    <span class="md-ellipsis">
      4. Get connected
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up-bioinformatics-software" class="md-nav__link">
    <span class="md-ellipsis">
      Set up bioinformatics software
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Set up bioinformatics software">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conda-initialisation" class="md-nav__link">
    <span class="md-ellipsis">
      Conda initialisation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-new-conda-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Create a new conda environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Download the data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assess-the-quality-of-the-raw-sequence-data" class="md-nav__link">
    <span class="md-ellipsis">
      Assess the quality of the raw sequence data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determine-the-genetic-resistance-profiles-of-tb-samples" class="md-nav__link">
    <span class="md-ellipsis">
      Determine the genetic resistance profiles of TB samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combine-the-reports" class="md-nav__link">
    <span class="md-ellipsis">
      Combine the reports
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="tb-drug-resistance-tutorial">TB Drug resistance tutorial</h1>
<h2 id="learing-objectives">Learing objectives</h2>
<ul>
<li>Asses the quality of raw sequence data</li>
<li>Determine the genetic resistance profiles of TB samples using TB-Profiler</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>In this tutorial, we will learn how to assess the quality of raw sequence data and determine the genetic resistance profiles of TB samples using TB-Profiler. We will be analysing data that was generated for a study that aimed to investigate the genetic diversity of TB strains the Phillipines: <a href="https://pubmed.ncbi.nlm.nih.gov/39179783/">Whole genome sequencing analysis of Mycobacterium tuberculosis reveals circulating strain types and drug-resistance mutations in the Philippines</a>.</p>
<h2 id="setting-up-the-environment">Setting up the environment</h2>
<p>These tools are written in different programming languages and have different dependencies and require a unix operating system to run. There are several options to set up the environment:
    * Install the tools on your local machine
    * Use a cloud-based platform such as AWS or Google Cloud to create a virtual machine
    * Use a containerisation platform such as Docker or Singularity</p>
<h3 id="installing-the-tools-on-your-local-machine">Installing the tools on your local machine</h3>
<div class="admonition danger">
<p class="admonition-title">Windows</p>
<p>This tutorial assumes that you are using a unix operating system. If you are on windows, you will first need to set up wsl on your machine. You can follow the instructions <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">here</a>. Following this,
you will have access to a unix terminal and can follow the instructions below.</p>
</div>
<p>We will be using a conda environment to manage these dependencies. If you don't have conda installed, you can follow the instructions <a href="https://conda-forge.org/download/">here</a>.</p>
<h3 id="using-github-codespaces">Using GitHub Codespaces</h3>
<p>If you don't want to install the tools on your local machine, you can use GitHub Codespaces to create a cloud-based virtual machine. This will allow you to run the tools in a unix environment without having to install anything on your local machine. You'll need to have a GitHub account to use this service.</p>
<h4 id="github-codespaces">GitHub Codespaces</h4>
<p>GitHub Codespaces is a cloud-based development environment that allows users to run and edit code directly in a virtual machine (VM) hosted by GitHub. It provides a fully configured workspace, pre-installed with necessary tools like Git, Python, and Docker, eliminating the need for users to set up a local environment. Every GitHub user has a certain number of free Codespace hours per month (120 for a free account), making it an ideal solution for doing some occasional bioinformatics. </p>
<h4 id="visual-studio-code-vs-code">Visual Studio Code (VS Code)</h4>
<p>VS Code is a lightweight yet powerful code editor that supports multiple programming languages. It also allows users to connect to GitHub Codespaces, allowing users to work on cloud-based VMs as if they were local files.
Users will launch GitHub Codespaces via VS Code, enabling them to interact with their virtual machine through a familiar coding interface.</p>
<h4 id="how-these-work-together">How These Work Together:</h4>
<ol>
<li>Users launch GitHub Codespaces to create a cloud-based virtual machine.</li>
<li>They connect to the VM using VS Code, accessing the terminal and code files.</li>
</ol>
<p>This setup allows users to work on cloud-hosted projects with both command-line and GUI access, making it ideal for bioinformatics and data analysis workflows.</p>
<h3 id="getting-set-up">Getting set up</h3>
<h4 id="1-set-up-a-github-account">1. Set up a GitHub account</h4>
<p>Head over to https://github.com/ and sign up for an account. You can skip this step if you already have an account.</p>
<h4 id="2-download-visual-studio-code">2. Download Visual Studio Code</h4>
<p>Get the latest version of vscode from https://code.visualstudio.com/ and follow install instructions from the website.</p>
<h4 id="4-get-connected">4. Get connected</h4>
<p>Once you have installed VScode, you can connect to your GitHub Codespace using the following steps:</p>
<ol>
<li>Open Visual Studio Code.</li>
<li>Install the GitHub Codespaces extension by clicking on the following link and following instructions: <a href="https://marketplace.visualstudio.com/items?itemName=GitHub.codespaces">GitHub Codespaces</a>.</li>
<li>Open the command palette by pressing <code>Ctrl+Shift+P</code> (Windows/Linux) or <code>Cmd+Shift+P</code> (Mac).</li>
<li>Type <code>Create new Codespace</code> and select the option.</li>
<li>Enter <code>jodyphelan/tb-dr-tutorial</code> in the repository field.</li>
<li>You will then be proppted to select a branch. You should select the <code>main</code> branch.</li>
<li>You will be asked what type of instance to create. Select <code>4 cores, 16GB RAM, 32 GB storage</code> option.</li>
</ol>
<p>It should take a few minutes to create the Codespace. Once it's ready, you will be able to access the terminal and files directly from VS Code.</p>
<p>You should see something like this:</p>
<p><img alt="Codespace" src="images/codespace.png" /></p>
<p>If you can't see the terminal, you can open it by clicking on <code>Terminal</code> in the top menu and selecting <code>New Terminal</code>.</p>
<h2 id="set-up-bioinformatics-software">Set up bioinformatics software</h2>
<p>Before we start, we need to set up the environment. We will be using the following tools:</p>
<ul>
<li>FastQC</li>
<li>MultiQC</li>
<li>TB-Profiler</li>
<li><abbr title="A format used to store sequence data with quality scores">fastq</abbr>-dl</li>
</ul>
<p>We can install these software using a tool called <code>conda</code>. Conda is an open-source package management system and environment management system that runs on Windows, macOS, and Linux. Conda quickly installs, runs, and updates packages and their dependencies. Conda easily creates, saves, loads, and switches between environments on your local computer. It was created for Python programs, but it can package and distribute software for any language.</p>
<p>Conda should already be installed in your Codespace. You can check this by running the following command:</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>--version
</code></pre></div>
<p>If you see a version number, then conda is installed. If not, you can install it by following the instructions <a href="https://conda.io/projects/conda/en/latest/user-guide/install/index.html">here</a>. Before we start installing tools, you'll need to initialise conda by running the following command:</p>
<h3 id="conda-initialisation">Conda initialisation</h3>
<p>Before we start installing tools, you'll need to initialise conda by running the following command:</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>init
<span class="nb">source</span><span class="w"> </span>~/.bashrc
</code></pre></div>
<p>This will initialise conda to be loaded every time you open a new terminal. Next we need to add software channels so that conda can find the tools we want to install. Channels are the locations where packages are stored. Conda packages are downloaded from remote channels, which are URLs to directories containing conda packages. The <a href="https://bioconda.github.io/">bioconda</a> channel contains bioinformatics software and the conda-forge channel contains a wide range of software packages. Use the following command to add the bioconda and conda-forge channels:</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>config<span class="w"> </span>--add<span class="w"> </span>channels<span class="w"> </span>bioconda
conda<span class="w"> </span>config<span class="w"> </span>--add<span class="w"> </span>channels<span class="w"> </span>conda-forge
conda<span class="w"> </span>config<span class="w"> </span>--set<span class="w"> </span>channel_priority<span class="w"> </span>strict
</code></pre></div>
<p>The actions above only need to be done once, so you won't need to run these commands again. </p>
<h3 id="create-a-new-conda-environment">Create a new conda environment</h3>
<p>Conda environments allow you to create isolated environments that have their own set of software installed. This is useful when you have different projects that require different versions of software. We will create a new conda environment called <code>tb</code> and install the required software in this environment. You can create a new conda environment by running the following command:</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>create<span class="w"> </span>-y<span class="w"> </span>-n<span class="w"> </span>tb<span class="w"> </span>fastqc<span class="w"> </span>multiqc<span class="w"> </span>tb-profiler<span class="w"> </span>fastq-dl
</code></pre></div>
<p>This step might take a few minutes (once you see <code>âžœ /workspaces/tb-dr-tutorial (main) $</code> again you'll be ready to continue). </p>
<p>This command will create a new conda environment called <code>tb</code> and install the required software. You can activate the environment by running the following command:</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>activate<span class="w"> </span>tb
</code></pre></div>
<p>You should see <code>(tb)</code> at the beginning of your terminal prompt, indicating that the <code>tb</code> environment is active.</p>
<h3 id="download-the-data">Download the data</h3>
<p>We will be using data from the study <a href="https://pubmed.ncbi.nlm.nih.gov/39179783/">Whole genome sequencing analysis of Mycobacterium tuberculosis reveals circulating strain types and drug-resistance mutations in the Philippines</a>. The data is available on the European Nucleotide Archive (ENA) under the accession number <a href="https://www.ebi.ac.uk/ena/browser/view/PRJEB37886">PRJEB37886</a>. We will be downloading the data using the <code>fastq-dl</code> tool. You can download the data by running the following command:</p>
<div class="highlight"><pre><span></span><code>fastq-dl<span class="w"> </span>-o<span class="w"> </span>data<span class="w"> </span>-a<span class="w"> </span>ERR6635398
fastq-dl<span class="w"> </span>-o<span class="w"> </span>data<span class="w"> </span>-a<span class="w"> </span>ERR6635159
fastq-dl<span class="w"> </span>-o<span class="w"> </span>data<span class="w"> </span>-a<span class="w"> </span>ERR6635124
fastq-dl<span class="w"> </span>-o<span class="w"> </span>data<span class="w"> </span>-a<span class="w"> </span>ERR6635248
fastq-dl<span class="w"> </span>-o<span class="w"> </span>data<span class="w"> </span>-a<span class="w"> </span>ERR6635174
fastq-dl<span class="w"> </span>-o<span class="w"> </span>data<span class="w"> </span>-a<span class="w"> </span>ERR6634973
</code></pre></div>
<p>This will download the raw sequence data for the samples with the accession numbers <code>ERR6635398</code>, <code>ERR6635159</code>, <code>ERR6635124</code>, <code>ERR6635248</code>, <code>ERR6635174</code>, and <code>ERR6634973</code> to a directory called <code>data</code>.</p>
<h3 id="assess-the-quality-of-the-raw-sequence-data">Assess the quality of the raw sequence data</h3>
<p>Before we start analysing the data, it's a good idea to assess the quality of the raw sequence data. We can do this using the <code>fastqc</code> tool. You can run <code>fastqc</code> on the raw sequence data by running the following command:</p>
<div class="highlight"><pre><span></span><code>fastqc<span class="w"> </span>data/*.fastq.gz
</code></pre></div>
<p>This will generate a report for each of the raw sequence data files. We will then combine the reports into a single report using the <code>multiqc</code> tool. You can run <code>multiqc</code> on the <code>fastqc</code> reports by running the following command:</p>
<div class="highlight"><pre><span></span><code>multiqc<span class="w"> </span>.
</code></pre></div>
<p>This will generate a report called <code>multiqc_report.html</code> that summarises the quality of the raw sequence data. You can open this on a web browser to view the report. Remember, if you are running this on a cloud-based platform, you will need to download the report to view it. You can download it by locating the file in the file explorer on the left-hand side of VS Code, right-clicking on the file, and selecting <code>Download</code>.</p>
<p>There are a few things that are important to look out for in the <code>fastqc/multiqc</code> reports, but the one you'll probably want to look at is the per base sequence quality. This shows the quality of the bases at each position in the read. You want to see a high quality score (green) across most positions. It may be normal to see a drop in quality towards the end of the read.</p>
<p>[<img alt="MultiQC report" src="images/multiqc.png" />]</p>
<h3 id="determine-the-genetic-resistance-profiles-of-tb-samples">Determine the genetic resistance profiles of TB samples</h3>
<p>Now that we have assessed the quality of the raw sequence data, we can determine the genetic resistance profiles of the TB samples using TB-Profiler. TB-Profiler is a tool that identifies genetic mutations associated with drug resistance in TB samples. You can run TB-Profiler on the raw sequence data by running the following commands:</p>
<div class="highlight"><pre><span></span><code>tb-profiler<span class="w"> </span>profile<span class="w"> </span>-1<span class="w"> </span>data/ERR6635398_1.fastq.gz<span class="w"> </span>-2<span class="w"> </span>data/ERR6635398_2.fastq.gz<span class="w">  </span>-p<span class="w"> </span>ERR6635398<span class="w"> </span>--snp_dist<span class="w"> </span><span class="m">100</span><span class="w">  </span>-t<span class="w"> </span><span class="m">4</span><span class="w"> </span>--txt
tb-profiler<span class="w"> </span>profile<span class="w"> </span>-1<span class="w"> </span>data/ERR6635159_1.fastq.gz<span class="w"> </span>-2<span class="w"> </span>data/ERR6635159_2.fastq.gz<span class="w">  </span>-p<span class="w"> </span>ERR6635159<span class="w"> </span>--snp_dist<span class="w"> </span><span class="m">100</span><span class="w">  </span>-t<span class="w"> </span><span class="m">4</span><span class="w"> </span>--txt
tb-profiler<span class="w"> </span>profile<span class="w"> </span>-1<span class="w"> </span>data/ERR6635124_1.fastq.gz<span class="w"> </span>-2<span class="w"> </span>data/ERR6635124_2.fastq.gz<span class="w">  </span>-p<span class="w"> </span>ERR6635124<span class="w"> </span>--snp_dist<span class="w"> </span><span class="m">100</span><span class="w">  </span>-t<span class="w"> </span><span class="m">4</span><span class="w"> </span>--txt
tb-profiler<span class="w"> </span>profile<span class="w"> </span>-1<span class="w"> </span>data/ERR6635248_1.fastq.gz<span class="w"> </span>-2<span class="w"> </span>data/ERR6635248_2.fastq.gz<span class="w">  </span>-p<span class="w"> </span>ERR6635248<span class="w"> </span>--snp_dist<span class="w"> </span><span class="m">100</span><span class="w">  </span>-t<span class="w"> </span><span class="m">4</span><span class="w"> </span>--txt
tb-profiler<span class="w"> </span>profile<span class="w"> </span>-1<span class="w"> </span>data/ERR6635174_1.fastq.gz<span class="w"> </span>-2<span class="w"> </span>data/ERR6635174_2.fastq.gz<span class="w">  </span>-p<span class="w"> </span>ERR6635174<span class="w"> </span>--snp_dist<span class="w"> </span><span class="m">100</span><span class="w">  </span>-t<span class="w"> </span><span class="m">4</span><span class="w"> </span>--txt
tb-profiler<span class="w"> </span>profile<span class="w"> </span>-1<span class="w"> </span>data/ERR6634973_1.fastq.gz<span class="w"> </span>-2<span class="w"> </span>data/ERR6634973_2.fastq.gz<span class="w">  </span>-p<span class="w"> </span>ERR6634973<span class="w"> </span>--snp_dist<span class="w"> </span><span class="m">100</span><span class="w">  </span>-t<span class="w"> </span><span class="m">4</span><span class="w"> </span>--txt
</code></pre></div>
<p>These commands may take a long time to run! This will run TB-Profiler on each of the raw sequence data files and generate a report for each sample. The reports will contain information about the genetic resistance profiles of the samples. You can open the reports in a text editor to view the results. Specific parameters are used to specify the location of the raw sequence data files (<code>-1</code> and <code>-2</code>), the output prefix (<code>-p</code>), the SNP distance to use when performing clustering (<code>--snp_dist</code>), and the number of threads (<code>-t</code>). The <code>--txt</code> option is used to generate a text report.</p>
<p>Take a look at one of the reports to see the results. The report will contain information about the genetic resistance profiles of the sample, including the mutations identified and their associated drug resistance. Here we will go through the sections of the report for sample <code>ERR6635398</code>:</p>
<div class="highlight"><pre><span></span><code>Summary
-------
ID: ERR6635398
Date: 2025-09-18 22:51:00.361166
Strain: lineage4.3.4.1
Drug-resistance: Pre-XDR-TB
Median Depth: 112.0
</code></pre></div>
<p>This section contains a summary of the sample, including the sample ID, date of analysis, strain lineage, drug resistance profile, and median depth of coverage.</p>
<div class="highlight"><pre><span></span><code>Lineage report
--------------
Lineage Fraction    Family  Rd
lineage4    100.000 Euro-American   None
lineage4.3  100.000 Euro-American (LAM) None
lineage4.3.4    100.000 Euro-American (LAM) RD174
lineage4.3.4.1  100.000 Euro-American (LAM) RD174
</code></pre></div>
<p>This section contains information about the lineage of the sample, including the lineage, the estimated fraction of the lineage and any associated family names. The Lineage system is hierarchical, so you can see the lineage broken down into sub-lineages.</p>
<div class="highlight"><pre><span></span><code>Resistance report
-----------------
Drug    Genotypic Resistance    Mechanisms
Rifampicin  R   rpoB p.Ser450Leu (1.00)
Isoniazid   R   katG p.Ser315Thr (1.00)
Ethambutol  R   embB p.Met306Val (1.00)
Pyrazinamide    R   pncA p.Leu172Pro (1.00)
Moxifloxacin    R   gyrA p.Asp94Asn (1.00)
Levofloxacin    R   gyrA p.Asp94Asn (1.00)
Bedaquiline     
Delamanid       
Pretomanid      
Linezolid       
Streptomycin    R   rrs n.514A&gt;C (1.00)
Amikacin    R   rrs n.1401A&gt;G (1.00)
Kanamycin   R   rrs n.1401A&gt;G (1.00)
Capreomycin R   rrs n.1401A&gt;G (1.00)
Clofazimine     
Ethionamide     
Para-aminosalicylic_acid        
Cycloserine
</code></pre></div>
<p>This section contains information about the drug resistance profile of the sample, including the drugs tested for, the genotypic resistance (R = resistant, blank = no resistance identified), and the mutation identified (frequency of mutation in parentheses).</p>
<div class="highlight"><pre><span></span><code>Resistance variants report
-----------------
Genome Position Locus Tag   Gene Name   Variant Type    Change  Depth   Estimated Fraction  Drug    Confidence  Comment
7581    Rv0006  gyrA    missense_variant    p.Asp94Asn  58  1.000   moxifloxacin,levofloxacin   Assoc w R   ,High-level resistance
761155  Rv0667  rpoB    missense_variant    p.Ser450Leu 66  1.000   rifampicin  Assoc w R   
1472359 EBG00000313325  rrs non_coding_transcript_exon_variant  n.514A&gt;C    82  1.000   streptomycin    Assoc w R   
1473246 EBG00000313325  rrs non_coding_transcript_exon_variant  n.1401A&gt;G   85  1.000   capreomycin,amikacin,kanamycin  Assoc w R   
2155168 Rv1908c katG    missense_variant    p.Ser315Thr 111 1.000   isoniazid   Assoc w R   High-level resistance
2288727 Rv2043c pncA    missense_variant    p.Leu172Pro 55  1.000   pyrazinamide    Assoc w R   
4247429 Rv3795  embB    missense_variant    p.Met306Val 86  1.000   ethambutol  Assoc w R
</code></pre></div>
<p>This section contains information about the specific mutations identified in the sample, including the genome position, gene name, type of variant, change, depth of coverage, estimated fraction of the mutation, associated drug, WHO confidence level, and any comments.</p>
<div class="highlight"><pre><span></span><code>Other variants report
---------------------
Genome Position Locus Tag   Gene Name   Variant Type    Change  Depth   Estimated Fraction  Gene Associated Drug    Confidence  Comment
7362    Rv0006  gyrA    missense_variant    p.Glu21Gln  77  1.000   moxifloxacin,levofloxacin   Not assoc w R   
7585    Rv0006  gyrA    missense_variant    p.Ser95Thr  61  1.000   moxifloxacin,levofloxacin   Not assoc w R   
9304    Rv0006  gyrA    missense_variant    p.Gly668Asp 75  1.000   moxifloxacin,levofloxacin   Not assoc w R   
576375  Rv0486  mshA    missense_variant    p.Ala343Val 55  1.000   isoniazid,ethionamide   Uncertain significance  
761496  Rv0667  rpoB    missense_variant    p.Tyr564His 84  0.988   rifampicin  Uncertain significance  
762506  Rv0667  rpoB    synonymous_variant  c.2700C&gt;T   77  0.974   rifampicin  Not assoc w R - Interim 
764995  Rv0668  rpoC    synonymous_variant  c.1626C&gt;G   114 1.000   rifampicin  Not assoc w R   
775639  Rv0676c mmpL5   missense_variant    p.Ile948Val 86  1.000   bedaquiline,clofazimine Not assoc w R - Interim,Not assoc w R   
781395  Rv0682  rpsL    upstream_gene_variant   c.-165T&gt;C   109 1.000   streptomycin    Not assoc w R   
1364434 Rv1221  sigE    missense_variant    p.Arg8Trp   119 1.000   pyrazinamide    Not assoc w R   
1471659 EBG00000313325  rrs upstream_gene_variant   n.-187C&gt;T   100 1.000   capreomycin,amikacin,kanamycin,streptomycin Uncertain significance  Not found in WHO catalogue
1854300 Rv1644  tsnR    missense_variant    p.Leu232Pro 46  1.000   linezolid   Not assoc w R   
1917972 Rv1694  tlyA    synonymous_variant  c.33A&gt;G 52  1.000   capreomycin Not assoc w R   
2223293 Rv1979c Rv1979c upstream_gene_variant   c.-129A&gt;G   79  1.000   bedaquiline,clofazimine Not assoc w R - Interim,Not assoc w R   
2726323 Rv2428  ahpC    missense_variant    p.Pro44Arg  90  1.000   isoniazid   Uncertain significance  
3073868 Rv2764c thyA    missense_variant    p.Thr202Ala 116 1.000   para-aminosalicylic_acid    Uncertain significance  Not found in WHO catalogue
3086788 Rv2780  ald upstream_gene_variant   c.-32T&gt;C    172 1.000   cycloserine Uncertain significance  Not found in WHO catalogue
3339496 Rv2983  fbiD    missense_variant    p.Glu127Gln 56  0.982   delamanid,pretomanid,clofazimine    Uncertain significance  Not found in WHO catalogue
3612009 Rv3236c Rv3236c missense_variant    p.Ala370Thr 60  1.000   pyrazinamide    Not assoc w R   
3625065 Rv3245c mtrB    missense_variant    p.Met517Leu 83  1.000   rifampicin,bedaquiline  Uncertain significance,Not assoc w R    
4038287 Rv3596c clpC1   synonymous_variant  c.2418C&gt;T   78  1.000   pyrazinamide    Not assoc w R   
4242643 Rv3793  embC    synonymous_variant  c.2781C&gt;T   48  1.000   ethambutol  Not assoc w R   
4247910 Rv3795  embB    missense_variant    p.Leu466Ser 67  1.000   ethambutol  Uncertain significance  
4338595 Rv3862c whiB6   upstream_gene_variant   c.-75delG   94  1.000   capreomycin,amikacin,kanamycin  Not assoc w R   
4338732 Rv3862c whiB6   upstream_gene_variant   c.-211C&gt;T   148 1.000   capreomycin,amikacin,kanamycin  Uncertain significance  Not found in WHO catalogue
4408156 Rv3919c gid missense_variant    p.Leu16Arg  79  1.000   streptomycin    Not assoc w R
</code></pre></div>
<p>This section contains information about other mutations identified in the sample that are not associated with drug resistance, including the genome position, gene name, type of variant, change, depth of coverage, estimated fraction of the mutation, associated drug (if any), WHO confidence level, and any comments.</p>
<div class="highlight"><pre><span></span><code>QC failed variants report
-------------------------

Genome Position Locus Tag   Gene Name   Variant Type    Change  Depth   Estimated Fraction  Gene Associated Drug    Confidence  Comment
576108  Rv0486  mshA    missense_variant    p.Ala254Gly 67  0.209
</code></pre></div>
<p>This section contains information about mutations that failed the quality control checks. This could be due to low depth of coverage, low estimated fraction or uneven strand support. These mutations should be interpreted with caution as they may represent sequencing artefacts.</p>
<h3 id="combine-the-reports">Combine the reports</h3>
<p>We can then combine the reports into a single report using the <code>collate</code> command:</p>
<div class="highlight"><pre><span></span><code>tb-profiler<span class="w"> </span>collate<span class="w"> </span>--itol
</code></pre></div>
<p>This will generate a few different files including:</p>
<pre><code>* tbprofiler.txt: A tab-delimited file containing the results of the TB-Profiler analysis
* tbprofiler.variants.csv: A CSV file containing the variants identified by TB-Profiler
* tbprofiler.transmission_graph.json: A JSON file containing the transmission graph of the samples
</code></pre>
<p>Download these files to view the results. You can open the <code>tbprofiler.txt</code> file in a spreadsheet program such as Excel or Google Sheets to view the results.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this tutorial, we have learned how to assess the quality of raw sequence data and determine the genetic resistance profiles of TB samples using TB-Profiler. We have also learned how to set up a conda environment and install the required software. You can now use these tools to analyse your own TB sequence data.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["content.tooltips", "navigation.instant", "navigation.tabs", "toc.integrate", "content.tabs.link"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>